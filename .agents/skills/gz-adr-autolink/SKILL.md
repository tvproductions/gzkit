---
name: gz-adr-autolink
description: Auto-map ADRs to tests via @covers decorators; optionally write Verification sections.
compatibility: GovZero v6 framework; discovers test-to-ADR traceability
metadata:
  skill-version: "1.0.0"
  govzero-framework-version: "v6"
  govzero-author: "GovZero governance team"
  govzero_layer: "Layer 1 — Evidence Gathering"
opsdev_command: adr autolink
invocation: uv run -m opsdev adr autolink
---

# gz-adr-autolink

Discover ADR→tests mappings via @covers decorators and optionally write Verification sections to ADR files.

**Command:** `uv run -m opsdev adr autolink`

**Layer:** Layer 1 — Evidence Gathering

---

## When to Use

- After adding tests with @covers decorators
- To update ADR Verification sections with test links
- To discover which tests cover which ADRs
- Before ADR audit to ensure traceability is documented

---

## Invocation

```text
/gz-adr-autolink
/gz-adr-autolink --write
```

**CLI equivalent:**

```bash
# Discover mappings (read-only)
uv run -m opsdev adr autolink

# Discover and write Verification sections to ADR files
uv run -m opsdev adr autolink --write
```

---

## Flags

| Flag | Default | Purpose |
|------|---------|---------|
| `--write` | `false` | Write Verification sections to ADR markdown files |

---

## How It Works

1. **Scan tests** for `@covers("ADR-X.Y.Z")` decorators
2. **Build mapping** of ADR → test files
3. **Report** which ADRs have test coverage
4. **Optionally write** Verification section to each ADR file

---

## @covers Decorator Pattern

Tests use the `@covers` decorator to declare ADR coverage:

```python
from tests.helpers import covers

@covers("ADR-0.0.19")
class TestManifestValidation(unittest.TestCase):
    def test_manifest_schema(self):
        ...
```

Multiple ADRs can be covered:

```python
@covers("ADR-0.0.19", "ADR-0.0.20")
def test_cross_cutting_feature():
    ...
```

---

## Output Example

```text
ADR-0.0.19: 3 tests
  - tests/warehouse/test_manifest.py::TestManifestValidation
  - tests/warehouse/test_manifest.py::TestManifestLoader
  - tests/integration/test_etl.py::TestManifestIntegration

ADR-0.0.20: 1 test
  - tests/config/test_schema.py::TestConfigSchema

ADR-0.0.21: 0 tests (UNCOVERED)
```

---

## Verification Section Format

When `--write` is used, ADR files get a Verification section:

```markdown
## Verification

Tests covering this ADR:

| Test | File |
|------|------|
| TestManifestValidation | tests/warehouse/test_manifest.py |
| TestManifestLoader | tests/warehouse/test_manifest.py |

Generated by `uv run -m opsdev adr autolink --write`
```

---

## Related Skills

| Skill | Purpose |
|-------|---------|
| gz-adr-verification | Full ADR→tests report with coverage stats |
| gz-adr-check | Blocking evidence audit |
| gz-obpi-audit | Audit individual OBPI briefs |

---

## References

- Command: `src/opsdev/commands/adr_subcommands.py`
- Decorator: `tests/helpers/covers.py`
